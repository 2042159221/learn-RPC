# Ming RPC Framework é‡è¯•æœºåˆ¶åŸç†ä¸å®ç°è¯¦è§£

## ğŸ“– æ¦‚è¿°

é‡è¯•æœºåˆ¶æ˜¯Ming RPC Frameworkä¸­å¤„ç†ä¸´æ—¶æ€§æ•…éšœçš„æ ¸å¿ƒç»„ä»¶ã€‚é€šè¿‡æ™ºèƒ½çš„é‡è¯•ç­–ç•¥å’Œçµæ´»çš„é…ç½®æœºåˆ¶ï¼Œæ¡†æ¶èƒ½å¤Ÿæœ‰æ•ˆåº”å¯¹ç½‘ç»œæŠ–åŠ¨ã€æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ç­‰é—®é¢˜ï¼Œæ˜¾è‘—æé«˜ç³»ç»Ÿçš„å¯é æ€§å’Œç”¨æˆ·ä½“éªŒã€‚

### ğŸ¯ é‡è¯•æœºåˆ¶çš„ä»·å€¼

1. **æé«˜å¯é æ€§**: è‡ªåŠ¨å¤„ç†ä¸´æ—¶æ€§æ•…éšœï¼Œå‡å°‘å› å¶å‘é”™è¯¯å¯¼è‡´çš„ä¸šåŠ¡å¤±è´¥
2. **æ”¹å–„ç”¨æˆ·ä½“éªŒ**: å‡å°‘ç”¨æˆ·æ„ŸçŸ¥åˆ°çš„é”™è¯¯ï¼Œæé«˜è¯·æ±‚æˆåŠŸç‡
3. **å¢å¼ºå®¹é”™èƒ½åŠ›**: ä¸å®¹é”™ç­–ç•¥é…åˆï¼Œæä¾›å¤šå±‚æ¬¡çš„æ•…éšœå¤„ç†
4. **é™ä½è¿ç»´æˆæœ¬**: è‡ªåŠ¨å¤„ç†ä¸´æ—¶æ€§æ•…éšœï¼Œå‡å°‘äººå·¥å¹²é¢„

## ğŸ”„ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨é‡è¯•æœºåˆ¶ï¼Ÿ

åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿå’Œå¾®æœåŠ¡æ¶æ„ä¸­ï¼ŒæœåŠ¡é—´çš„é€šä¿¡æ˜¯é€šè¿‡ç½‘ç»œè¿›è¡Œçš„ï¼Œè€Œç½‘ç»œç¯å¢ƒå¤©ç„¶å°±æ˜¯ä¸å¯é çš„ã€‚ä½¿ç”¨é‡è¯•æœºåˆ¶çš„ä¸»è¦åŸå› æœ‰ï¼š

1. **åº”å¯¹ç½‘ç»œæŠ–åŠ¨**ï¼šç½‘ç»œå¯èƒ½ä¼šå‡ºç°çŸ­æš‚çš„ä¸å¯ç”¨æˆ–å»¶è¿Ÿå¢é«˜ï¼Œè¿™äº›éƒ½æ˜¯ä¸´æ—¶æ€§æ•…éšœï¼Œé€šè¿‡é‡è¯•å¯ä»¥å…‹æœè¿™ç±»é—®é¢˜
2. **å¤„ç†æœåŠ¡ä¸´æ—¶è¿‡è½½**ï¼šæœåŠ¡å™¨å¯èƒ½å› ä¸ºçªå‘æµé‡å¯¼è‡´çŸ­æš‚çš„å“åº”è¶…æ—¶ï¼Œé‡è¯•å¯ä»¥å°†è¯·æ±‚åˆ†æ•£åˆ°ä¸åŒæ—¶é—´ç‚¹
3. **æé«˜ç³»ç»Ÿå¯ç”¨æ€§**ï¼šå¯¹äºé‡è¦çš„ä¸šåŠ¡æ“ä½œï¼Œé€šè¿‡åˆç†çš„é‡è¯•å¯ä»¥æé«˜æ“ä½œçš„æœ€ç»ˆæˆåŠŸç‡
4. **åº”å¯¹åˆ†å¸ƒå¼ç³»ç»Ÿçš„éƒ¨åˆ†å¤±è´¥**ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œéƒ¨åˆ†å¤±è´¥æ˜¯å¸¸æ€è€Œéå¼‚å¸¸ï¼Œé‡è¯•æ˜¯å¤„ç†éƒ¨åˆ†å¤±è´¥çš„é‡è¦æ‰‹æ®µ
5. **é™ä½å¼€å‘å¤æ‚åº¦**ï¼šé€šè¿‡æ¡†æ¶æä¾›çš„è‡ªåŠ¨é‡è¯•æœºåˆ¶ï¼Œå¼€å‘è€…ä¸éœ€è¦æ‰‹åŠ¨ç¼–å†™é‡è¯•é€»è¾‘

## é‡è¯•æœºåˆ¶å·¥ä½œåŸç†

```mermaid
flowchart TD
    A[å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚] --> B{è¯·æ±‚æ˜¯å¦æˆåŠŸ?}
    B -->|æˆåŠŸ| C[è¿”å›ç»“æœ]
    B -->|å¤±è´¥| D{æ˜¯å¦æ»¡è¶³é‡è¯•æ¡ä»¶?}
    D -->|ä¸æ»¡è¶³| E[è¿”å›å¤±è´¥]
    D -->|æ»¡è¶³| F{é‡è¯•æ¬¡æ•°<æœ€å¤§æ¬¡æ•°?}
    F -->|æ˜¯| G[ç­‰å¾…é‡è¯•é—´éš”]
    G --> H[é‡è¯•æ¬¡æ•°+1]
    H --> A
    F -->|å¦| E
```

é‡è¯•æœºåˆ¶çš„åŸºæœ¬å·¥ä½œæµç¨‹ï¼š

1. å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚
2. æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ
3. å¦‚æœæˆåŠŸï¼Œè¿”å›ç»“æœ
4. å¦‚æœå¤±è´¥ï¼Œåˆ¤æ–­æ˜¯å¦æ»¡è¶³é‡è¯•æ¡ä»¶
5. å¦‚æœæ»¡è¶³é‡è¯•æ¡ä»¶ä¸”æœªè¶…è¿‡æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œç­‰å¾…ä¸€æ®µæ—¶é—´åé‡è¯•
6. å¦‚æœä¸æ»¡è¶³é‡è¯•æ¡ä»¶æˆ–å·²è¾¾æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œè¿”å›å¤±è´¥

## å¸¸è§çš„é‡è¯•ç­–ç•¥

### 1. ç«‹å³é‡è¯•ï¼ˆImmediate Retryï¼‰

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant Server as æœåŠ¡ç«¯
    
    Client->>Server: è¯·æ±‚1
    Server-->>Client: å¤±è´¥
    Note over Client: ç«‹å³é‡è¯•
    Client->>Server: è¯·æ±‚2
    Server-->>Client: å¤±è´¥
    Note over Client: ç«‹å³é‡è¯•
    Client->>Server: è¯·æ±‚3
    Server-->>Client: æˆåŠŸ
```

**ç‰¹ç‚¹**ï¼š
- å¤±è´¥åç«‹å³è¿›è¡Œä¸‹ä¸€æ¬¡å°è¯•
- é€‚ç”¨äºå¯¹å»¶è¿Ÿæ•æ„Ÿçš„åœºæ™¯
- å®ç°ç®€å•

**ç¼ºç‚¹**ï¼š
- å¦‚æœæœåŠ¡å™¨è¿‡è½½æ˜¯å¯¼è‡´å¤±è´¥çš„åŸå› ï¼Œç«‹å³é‡è¯•å¯èƒ½ä¼šåŠ å‰§é—®é¢˜
- å¯èƒ½å¯¼è‡´"æƒŠç¾¤æ•ˆåº”"ï¼Œå¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶é‡è¯•

### 2. å›ºå®šé—´éš”é‡è¯•ï¼ˆFixed Delayï¼‰

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant Server as æœåŠ¡ç«¯
    
    Client->>Server: è¯·æ±‚1
    Server-->>Client: å¤±è´¥
    Note over Client: ç­‰å¾…1ç§’
    Client->>Server: è¯·æ±‚2
    Server-->>Client: å¤±è´¥
    Note over Client: ç­‰å¾…1ç§’
    Client->>Server: è¯·æ±‚3
    Server-->>Client: æˆåŠŸ
```

**ç‰¹ç‚¹**ï¼š
- æ¯æ¬¡é‡è¯•ä¹‹é—´ç­‰å¾…å›ºå®šçš„æ—¶é—´é—´éš”
- ç»™æœåŠ¡å™¨ç•™å‡ºæ¢å¤çš„æ—¶é—´
- é…ç½®ç®€å•

**ç¼ºç‚¹**ï¼š
- åœ¨æœåŠ¡è´Ÿè½½é«˜å³°æœŸï¼Œå›ºå®šé—´éš”å¯èƒ½ä¸å¤Ÿçµæ´»
- å¤šä¸ªå®¢æˆ·ç«¯å¯èƒ½åœ¨åŒä¸€æ—¶é—´è¿›è¡Œé‡è¯•

### 3. æŒ‡æ•°é€€é¿é‡è¯•ï¼ˆExponential Backoffï¼‰

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant Server as æœåŠ¡ç«¯
    
    Client->>Server: è¯·æ±‚1
    Server-->>Client: å¤±è´¥
    Note over Client: ç­‰å¾…1ç§’
    Client->>Server: è¯·æ±‚2
    Server-->>Client: å¤±è´¥
    Note over Client: ç­‰å¾…2ç§’
    Client->>Server: è¯·æ±‚3
    Server-->>Client: å¤±è´¥
    Note over Client: ç­‰å¾…4ç§’
    Client->>Server: è¯·æ±‚4
    Server-->>Client: æˆåŠŸ
```

**ç‰¹ç‚¹**ï¼š
- é‡è¯•ç­‰å¾…æ—¶é—´å‘ˆæŒ‡æ•°å¢é•¿ï¼ˆå¦‚1s, 2s, 4s, 8s...ï¼‰
- éšç€å¤±è´¥æ¬¡æ•°å¢åŠ ï¼Œç»™æœåŠ¡æ›´å¤šæ¢å¤æ—¶é—´
- é€‚ç”¨äºæœåŠ¡å¯èƒ½éœ€è¦è¾ƒé•¿æ¢å¤æ—¶é—´çš„åœºæ™¯

**ç¼ºç‚¹**ï¼š
- ç­‰å¾…æ—¶é—´å¯èƒ½å˜å¾—å¾ˆé•¿
- ä»ç„¶å­˜åœ¨æ‰€æœ‰å®¢æˆ·ç«¯åŒæ—¶é‡è¯•çš„é£é™©

### 4. å¸¦æŠ–åŠ¨çš„æŒ‡æ•°é€€é¿ï¼ˆExponential Backoff with Jitterï¼‰

```mermaid
sequenceDiagram
    participant Client1 as å®¢æˆ·ç«¯1
    participant Client2 as å®¢æˆ·ç«¯2
    participant Server as æœåŠ¡ç«¯
    
    Client1->>Server: è¯·æ±‚
    Client2->>Server: è¯·æ±‚
    Server-->>Client1: å¤±è´¥
    Server-->>Client2: å¤±è´¥
    
    Note over Client1: è®¡ç®—åŸºç¡€å»¶è¿Ÿ=1ç§’<br>æ·»åŠ éšæœºæŠ–åŠ¨=0.3ç§’<br>ç­‰å¾…1.3ç§’
    Note over Client2: è®¡ç®—åŸºç¡€å»¶è¿Ÿ=1ç§’<br>æ·»åŠ éšæœºæŠ–åŠ¨=0.7ç§’<br>ç­‰å¾…1.7ç§’
    
    Client1->>Server: é‡è¯•
    Server-->>Client1: å¤±è´¥
    
    Note over Client1: è®¡ç®—åŸºç¡€å»¶è¿Ÿ=2ç§’<br>æ·»åŠ éšæœºæŠ–åŠ¨=0.5ç§’<br>ç­‰å¾…2.5ç§’
    
    Client2->>Server: é‡è¯•
    Server-->>Client2: æˆåŠŸ
    
    Client1->>Server: é‡è¯•
    Server-->>Client1: æˆåŠŸ
```

**ç‰¹ç‚¹**ï¼š
- åœ¨æŒ‡æ•°é€€é¿çš„åŸºç¡€ä¸Šå¢åŠ éšæœºå› ç´ 
- é¿å…å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶é‡è¯•å¯¼è‡´çš„"æƒŠç¾¤æ•ˆåº”"
- æ›´å‡åŒ€åœ°åˆ†æ•£é‡è¯•è¯·æ±‚

**ä¼˜åŠ¿**ï¼š
- æ›´å¥½çš„ç³»ç»Ÿç¨³å®šæ€§
- æ›´é«˜çš„è¯·æ±‚æˆåŠŸç‡
- é¿å…åŒæ­¥æ•ˆåº”

## é‡è¯•æ¡ä»¶ä¸å¼‚å¸¸åˆ†ç±»

å¹¶éæ‰€æœ‰å¤±è´¥éƒ½é€‚åˆé‡è¯•ï¼Œé€šå¸¸åªæœ‰ä¸´æ—¶æ€§æ•…éšœæ‰é€‚åˆé‡è¯•ã€‚å¼‚å¸¸å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼š

1. **å¿…å®šä¼šæˆåŠŸçš„é‡è¯•ï¼ˆRetryableï¼‰**ï¼š
   - ç½‘ç»œæŠ–åŠ¨
   - è¿æ¥è¶…æ—¶
   - æœåŠ¡æš‚æ—¶ä¸å¯ç”¨ï¼ˆHTTP 503ï¼‰
   - èµ„æºå†²çªï¼ˆHTTP 409ï¼‰

2. **å¯èƒ½æˆåŠŸçš„é‡è¯•ï¼ˆMaybe Retryableï¼‰**ï¼š
   - è¯»è¶…æ—¶
   - éƒ¨åˆ†æœåŠ¡å™¨é”™è¯¯ï¼ˆHTTP 500ï¼‰
   - è¯·æ±‚è¶…æ—¶

3. **ä¸åº”é‡è¯•ï¼ˆNon-Retryableï¼‰**ï¼š
   - è®¤è¯å¤±è´¥ï¼ˆHTTP 401/403ï¼‰
   - èµ„æºä¸å­˜åœ¨ï¼ˆHTTP 404ï¼‰
   - å‚æ•°é”™è¯¯ï¼ˆHTTP 400ï¼‰
   - ä¸šåŠ¡é€»è¾‘é”™è¯¯

```mermaid
flowchart LR
    A[è¯·æ±‚å¤±è´¥] --> B{å¤±è´¥ç±»å‹?}
    B -->|ç½‘ç»œè¶…æ—¶| C[å¯é‡è¯•]
    B -->|è®¤è¯å¤±è´¥| D[ä¸å¯é‡è¯•]
    B -->|æœåŠ¡å™¨é”™è¯¯| E[å¯èƒ½å¯é‡è¯•]
    
    C --> F[æ‰§è¡Œé‡è¯•ç­–ç•¥]
    D --> G[ç›´æ¥è¿”å›å¤±è´¥]
    E --> H{å…·ä½“é”™è¯¯åˆ†æ}
    H -->|ä¸´æ—¶æ€§æ•…éšœ| F
    H -->|æ°¸ä¹…æ€§æ•…éšœ| G
```

## å¹‚ç­‰æ€§ä¸é‡è¯•

å¹‚ç­‰æ€§æ˜¯æŒ‡å¤šæ¬¡æ‰§è¡Œç›¸åŒçš„æ“ä½œï¼Œäº§ç”Ÿçš„å½±å“ä¸ä¸€æ¬¡æ‰§è¡Œçš„å½±å“ç›¸åŒã€‚åœ¨å®ç°é‡è¯•æœºåˆ¶æ—¶ï¼Œå¿…é¡»è€ƒè™‘æ“ä½œçš„å¹‚ç­‰æ€§ï¼š

```mermaid
flowchart TD
    subgraph "å¹‚ç­‰æ“ä½œ"
        A1[æ“ä½œ] --> B1[çŠ¶æ€1]
        B1 --> C1[æ“ä½œ]
        C1 --> D1[çŠ¶æ€1]
    end
    
    subgraph "éå¹‚ç­‰æ“ä½œ"
        A2[æ“ä½œ] --> B2[çŠ¶æ€1]
        B2 --> C2[æ“ä½œ]
        C2 --> D2[çŠ¶æ€2]
    end
```

- **å¹‚ç­‰æ“ä½œ**å¯ä»¥å®‰å…¨åœ°é‡è¯•ï¼Œä¾‹å¦‚ï¼š
  - æŸ¥è¯¢æ“ä½œï¼ˆGETï¼‰
  - æœ‰å”¯ä¸€æ ‡è¯†çš„æ›´æ–°æ“ä½œ
  - åŸºäºæ¡ä»¶çš„æ›´æ–°æ“ä½œ

- **éå¹‚ç­‰æ“ä½œ**é‡è¯•æ—¶éœ€è¦æ³¨æ„ï¼Œä¾‹å¦‚ï¼š
  - èµ„é‡‘è½¬è´¦
  - è®¡æ•°å™¨é€’å¢
  - æ— æ¡ä»¶çš„æ•°æ®æ’å…¥

**å®ç°å¹‚ç­‰æ€§çš„å¸¸è§æ–¹å¼**ï¼š
1. ä½¿ç”¨å”¯ä¸€æ ‡è¯†ï¼ˆå¦‚æ“ä½œIDï¼‰
2. å®ç°åŸºäºæ¡ä»¶çš„æ›´æ–°
3. ä½¿ç”¨åˆ†å¸ƒå¼é”
4. ç»´æŠ¤æ“ä½œçŠ¶æ€è¡¨

## ğŸ”§ Ming RPC Frameworké‡è¯•ç­–ç•¥å®ç°

### æ ¸å¿ƒæ¥å£è®¾è®¡
**æ–‡ä»¶è·¯å¾„**: `rpc-core/src/main/java/com/ming/rpc/fault/retry/RetryStrategy.java`

```java
public interface RetryStrategy {
    /**
     * é‡è¯•
     * @param callable å¯è°ƒç”¨å¯¹è±¡
     * @return è¿”å›ç»“æœ
     * @throws Exception å¼‚å¸¸
     */
    RpcResponse doRetry(Callable<RpcResponse> callable) throws Exception;
}
```

### 1. ä¸é‡è¯•ç­–ç•¥ (No Retry)
**æ–‡ä»¶è·¯å¾„**: `rpc-core/src/main/java/com/ming/rpc/fault/retry/NoRetryStrategy.java`

```java
public class NoRetryStrategy implements RetryStrategy {
    @Override
    public RpcResponse doRetry(Callable<RpcResponse> callable) throws Exception {
        return callable.call();
    }
}
```

**å·¥ä½œåŸç†**:
```mermaid
flowchart TD
    A[RPCè°ƒç”¨] --> B[æ‰§è¡Œä¸€æ¬¡]
    B --> C{è°ƒç”¨æ˜¯å¦æˆåŠŸ?}
    C -->|æˆåŠŸ| D[è¿”å›ç»“æœ]
    C -->|å¤±è´¥| E[ç›´æ¥æŠ›å‡ºå¼‚å¸¸]
```

**ç‰¹ç‚¹**:
- âœ… æ€§èƒ½æœ€é«˜ï¼Œæ— é¢å¤–å¼€é”€
- âœ… é€‚ç”¨äºå¯¹å®æ—¶æ€§è¦æ±‚æé«˜çš„åœºæ™¯
- âœ… å®ç°ç®€å•ï¼Œæ— å¤æ‚é€»è¾‘
- âŒ æ— æ³•å¤„ç†ä¸´æ—¶æ€§æ•…éšœ
- âŒ ç³»ç»Ÿå¯é æ€§è¾ƒä½

**é€‚ç”¨åœºæ™¯**: å®æ—¶äº¤æ˜“ç³»ç»Ÿã€å¯¹å»¶è¿Ÿæ•æ„Ÿçš„æœåŠ¡

### 2. å›ºå®šé—´éš”é‡è¯•ç­–ç•¥ (Fixed Interval)
**æ–‡ä»¶è·¯å¾„**: `rpc-core/src/main/java/com/ming/rpc/fault/retry/FixedIntervalRetryStrategy.java`

```java
public class FixedIntervalRetryStrategy implements RetryStrategy {
    @Override
    public RpcResponse doRetry(Callable<RpcResponse> callable) throws ExecutionException, RetryException {
        Retryer<RpcResponse> retryer = RetryerBuilder.<RpcResponse>newBuilder()
            .retryIfExceptionOfType(Exception.class)
            .withWaitStrategy(WaitStrategies.fixedWait(3L, TimeUnit.SECONDS))
            .withStopStrategy(StopStrategies.stopAfterAttempt(3))
            .withRetryListener(new RetryListener() {
                @Override
                public <V> void onRetry(Attempt<V> attempt) {
                    if (attempt.hasException()) {
                        System.out.println("é‡è¯•æ¬¡æ•°ï¼š" + attempt.getAttemptNumber() +
                                         "ï¼Œå¼‚å¸¸ï¼š" + attempt.getExceptionCause());
                    }
                }
            })
            .build();
        return retryer.call(callable);
    }
}
```

**å·¥ä½œåŸç†**:
```mermaid
flowchart TD
    A[RPCè°ƒç”¨] --> B[æ‰§è¡Œè°ƒç”¨]
    B --> C{è°ƒç”¨æ˜¯å¦æˆåŠŸ?}
    C -->|æˆåŠŸ| D[è¿”å›ç»“æœ]
    C -->|å¤±è´¥| E{æ˜¯å¦è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°?}
    E -->|æ˜¯| F[æŠ›å‡ºå¼‚å¸¸]
    E -->|å¦| G[ç­‰å¾…3ç§’]
    G --> B
```

**ç‰¹ç‚¹**:
- âœ… å®ç°ç®€å•ï¼Œè¡Œä¸ºå¯é¢„æµ‹
- âœ… é€‚ç”¨äºç½‘ç»œæŠ–åŠ¨ç­‰çŸ­æš‚æ•…éšœ
- âœ… é‡è¯•é—´éš”å¯é…ç½®
- âœ… åŸºäºGuava Retryingåº“ï¼ŒåŠŸèƒ½å¼ºå¤§
- âŒ å¯èƒ½å¯¼è‡´æœåŠ¡å™¨å‹åŠ›é›†ä¸­
- âŒ ä¸é€‚åˆé•¿æ—¶é—´æ•…éšœ

**é€‚ç”¨åœºæ™¯**: ç½‘ç»œæŠ–åŠ¨ã€ä¸´æ—¶æ€§æœåŠ¡ä¸å¯ç”¨

### ä»£ç å®ç°ç¤ºä¾‹

#### 1. é‡è¯•ç­–ç•¥æ¥å£

```java
/**
 * é‡è¯•ç­–ç•¥æ¥å£
 */
public interface RetryStrategy {
    /**
     * è®¡ç®—é‡è¯•ç­‰å¾…æ—¶é—´
     * @param attempt å½“å‰æ˜¯ç¬¬å‡ æ¬¡é‡è¯•ï¼ˆä»1å¼€å§‹ï¼‰
     * @return éœ€è¦ç­‰å¾…çš„æ¯«ç§’æ•°
     */
    long getDelayMillis(int attempt);
}
```

#### 2. ä¸åŒé‡è¯•ç­–ç•¥å®ç°

```java
/**
 * ç«‹å³é‡è¯•ç­–ç•¥
 */
public class ImmediateRetry implements RetryStrategy {
    @Override
    public long getDelayMillis(int attempt) {
        return 0; // ç«‹å³é‡è¯•ï¼Œä¸ç­‰å¾…
    }
}

/**
 * å›ºå®šé—´éš”é‡è¯•ç­–ç•¥
 */
public class FixedDelayRetry implements RetryStrategy {
    private final long delayMillis;
    
    public FixedDelayRetry(long delayMillis) {
        this.delayMillis = delayMillis;
    }
    
    @Override
    public long getDelayMillis(int attempt) {
        return delayMillis;
    }
}

/**
 * æŒ‡æ•°é€€é¿é‡è¯•ç­–ç•¥
 */
public class ExponentialBackoffRetry implements RetryStrategy {
    private final long initialDelayMillis;
    private final long maxDelayMillis;
    
    public ExponentialBackoffRetry(long initialDelayMillis, long maxDelayMillis) {
        this.initialDelayMillis = initialDelayMillis;
        this.maxDelayMillis = maxDelayMillis;
    }
    
    @Override
    public long getDelayMillis(int attempt) {
        // è®¡ç®—æŒ‡æ•°é€€é¿æ—¶é—´
        long delay = initialDelayMillis * (long)Math.pow(2, attempt - 1);
        // ç¡®ä¿ä¸è¶…è¿‡æœ€å¤§å»¶è¿Ÿæ—¶é—´
        return Math.min(delay, maxDelayMillis);
    }
}

/**
 * å¸¦æŠ–åŠ¨çš„é‡è¯•ç­–ç•¥ï¼ˆè£…é¥°å™¨æ¨¡å¼ï¼‰
 */
public class JitterRetry implements RetryStrategy {
    private final RetryStrategy baseStrategy;
    private final double jitterFactor;
    private final Random random = new Random();
    
    public JitterRetry(RetryStrategy baseStrategy, double jitterFactor) {
        this.baseStrategy = baseStrategy;
        this.jitterFactor = jitterFactor;
    }
    
    @Override
    public long getDelayMillis(int attempt) {
        long baseDelay = baseStrategy.getDelayMillis(attempt);
        // è®¡ç®—æŠ–åŠ¨èŒƒå›´
        long jitterRange = (long)(baseDelay * jitterFactor);
        // æ·»åŠ éšæœºæŠ–åŠ¨
        return baseDelay + (jitterRange > 0 ? random.nextLong() % jitterRange : 0);
    }
}
```

#### 3. é‡è¯•ç­–ç•¥é…ç½®

```java
/**
 * é‡è¯•ç­–ç•¥é…ç½®
 */
public class RetryPolicy {
    private final int maxRetries;
    private final RetryStrategy retryStrategy;
    private final Set<Class<? extends Exception>> retryableExceptions;
    
    public RetryPolicy(int maxRetries, RetryStrategy retryStrategy) {
        this(maxRetries, retryStrategy, new HashSet<>());
    }
    
    public RetryPolicy(int maxRetries, RetryStrategy retryStrategy, 
                      Set<Class<? extends Exception>> retryableExceptions) {
        this.maxRetries = maxRetries;
        this.retryStrategy = retryStrategy;
        this.retryableExceptions = retryableExceptions;
        
        // æ·»åŠ é»˜è®¤çš„å¯é‡è¯•å¼‚å¸¸
        if (retryableExceptions.isEmpty()) {
            retryableExceptions.add(IOException.class);
            retryableExceptions.add(TimeoutException.class);
            retryableExceptions.add(ConnectException.class);
        }
    }
    
    public boolean shouldRetry(Exception e) {
        // æ£€æŸ¥å¼‚å¸¸æ˜¯å¦æ˜¯å¯é‡è¯•çš„ç±»å‹
        for (Class<? extends Exception> exceptionClass : retryableExceptions) {
            if (exceptionClass.isInstance(e)) {
                return true;
            }
        }
        return false;
    }
    
    public int getMaxRetries() {
        return maxRetries;
    }
    
    public long getDelayMillis(int attempt) {
        return retryStrategy.getDelayMillis(attempt);
    }
}
```

#### 4. HttpClientä¸­é›†æˆé‡è¯•æœºåˆ¶

```java
/**
 * å¸¦é‡è¯•åŠŸèƒ½çš„HTTPå®¢æˆ·ç«¯
 */
public class RetryableHttpClient {
    private final WebClient webClient;
    private final Serializer serializer;
    private final RetryPolicy retryPolicy;
    
    /**
     * æ„é€ å¸¦é‡è¯•åŠŸèƒ½çš„HTTPå®¢æˆ·ç«¯
     */
    public RetryableHttpClient(RetryPolicy retryPolicy) {
        // åˆ›å»ºVertxå®ä¾‹
        Vertx vertx = Vertx.vertx();
        
        // é…ç½®WebClienté€‰é¡¹
        WebClientOptions options = new WebClientOptions();
        options.setKeepAlive(true);
        options.setConnectTimeout(5000); // è¿æ¥è¶…æ—¶æ—¶é—´
        
        // åˆ›å»ºWebClient
        this.webClient = WebClient.create(vertx, options);
        
        // è®¾ç½®åºåˆ—åŒ–å™¨
        this.serializer = new JdkSerializer();
        
        // è®¾ç½®é‡è¯•ç­–ç•¥
        this.retryPolicy = retryPolicy;
    }
    
    /**
     * å‘é€å¸¦é‡è¯•åŠŸèƒ½çš„HTTPè¯·æ±‚
     */
    public RpcResponse sendRequest(RpcRequest rpcRequest, String host, int port) {
        int attempts = 0;
        Exception lastException = null;
        
        while (attempts <= retryPolicy.getMaxRetries()) {
            try {
                if (attempts > 0) {
                    System.out.println("Retry attempt " + attempts + " for request to " 
                                      + host + ":" + port);
                    // ç­‰å¾…é‡è¯•é—´éš”
                    Thread.sleep(retryPolicy.getDelayMillis(attempts));
                }
                
                // å‘é€è¯·æ±‚
                RpcResponse response = doSendRequest(rpcRequest, host, port);
                
                // æ£€æŸ¥å“åº”æ˜¯å¦åŒ…å«å¼‚å¸¸
                if (response.getException() != null) {
                    if (retryPolicy.shouldRetry(response.getException())) {
                        // å¯é‡è¯•å¼‚å¸¸ï¼Œç»§ç»­å¾ªç¯
                        lastException = response.getException();
                    } else {
                        // ä¸å¯é‡è¯•å¼‚å¸¸ï¼Œç›´æ¥è¿”å›
                        return response;
                    }
                } else {
                    // æˆåŠŸå“åº”
                    return response;
                }
            } catch (Exception e) {
                lastException = e;
                if (!retryPolicy.shouldRetry(e)) {
                    // ä¸å¯é‡è¯•å¼‚å¸¸ï¼Œç›´æ¥åˆ›å»ºé”™è¯¯å“åº”å¹¶è¿”å›
                    RpcResponse errorResponse = new RpcResponse();
                    errorResponse.setException(e);
                    errorResponse.setMessage("å®¢æˆ·ç«¯è¯·æ±‚å¼‚å¸¸: " + e.getMessage());
                    return errorResponse;
                }
                // å¯é‡è¯•å¼‚å¸¸ï¼Œç»§ç»­å¾ªç¯
            }
            
            attempts++;
        }
        
        // æ‰€æœ‰é‡è¯•éƒ½å¤±è´¥
        RpcResponse errorResponse = new RpcResponse();
        errorResponse.setException(lastException);
        errorResponse.setMessage("è¯·æ±‚å¤±è´¥ï¼Œé‡è¯•" + retryPolicy.getMaxRetries() + "æ¬¡åä»æœªæˆåŠŸ");
        return errorResponse;
    }
    
    /**
     * å®é™…å‘é€HTTPè¯·æ±‚
     */
    private RpcResponse doSendRequest(RpcRequest rpcRequest, String host, int port) throws Exception {
        CompletableFuture<RpcResponse> responseFuture = new CompletableFuture<>();
        
        // åºåˆ—åŒ–è¯·æ±‚
        byte[] requestBytes = serializer.serialize(rpcRequest);
        
        // å‘é€POSTè¯·æ±‚
        webClient.request(HttpMethod.POST, port, host, "/")
                .sendBuffer(Buffer.buffer(requestBytes), ar -> {
                    if (ar.succeeded()) {
                        try {
                            // è·å–å“åº”å†…å®¹
                            Buffer responseBuffer = ar.result().body();
                            // ååºåˆ—åŒ–å“åº”
                            RpcResponse rpcResponse = serializer.deserialize(
                                    responseBuffer.getBytes(), 
                                    RpcResponse.class
                            );
                            // å®ŒæˆFuture
                            responseFuture.complete(rpcResponse);
                        } catch (Exception e) {
                            // å¤„ç†å¼‚å¸¸
                            responseFuture.completeExceptionally(e);
                        }
                    } else {
                        // å¤„ç†è¯·æ±‚å¤±è´¥
                        responseFuture.completeExceptionally(ar.cause());
                    }
                });
        
        // ç­‰å¾…å“åº”
        return responseFuture.get(10, TimeUnit.SECONDS);
    }
}
```

#### 5. é€šè¿‡é…ç½®æˆ–æ³¨è§£ä½¿ç”¨é‡è¯•æœºåˆ¶

```java
/**
 * é‡è¯•æ³¨è§£
 */
@Retention(RetentionPolicy.RUNTIME)
@Target({ElementType.METHOD, ElementType.TYPE})
public @interface Retryable {
    /**
     * æœ€å¤§é‡è¯•æ¬¡æ•°
     */
    int maxRetries() default 3;
    
    /**
     * åˆå§‹å»¶è¿Ÿæ¯«ç§’æ•°
     */
    long initialDelay() default 1000;
    
    /**
     * é‡è¯•ç­–ç•¥ç±»å‹
     */
    RetryStrategyType strategy() default RetryStrategyType.EXPONENTIAL_BACKOFF;
    
    /**
     * å¯é‡è¯•çš„å¼‚å¸¸ç±»
     */
    Class<? extends Exception>[] retryFor() default {IOException.class, TimeoutException.class};
    
    /**
     * ä¸å¯é‡è¯•çš„å¼‚å¸¸ç±»
     */
    Class<? extends Exception>[] noRetryFor() default {};
    
    /**
     * ç­–ç•¥ç±»å‹æšä¸¾
     */
    enum RetryStrategyType {
        IMMEDIATE,
        FIXED_DELAY,
        EXPONENTIAL_BACKOFF,
        EXPONENTIAL_BACKOFF_WITH_JITTER
    }
}
```

## é¡¹ç›®ä¸­çš„é‡è¯•æœºåˆ¶å®ç°

åœ¨å½“å‰çš„learn-RPCé¡¹ç›®ä¸­ï¼Œç›®å‰çš„HttpClientå®ç°ä»…è®¾ç½®äº†è¿æ¥è¶…æ—¶ï¼Œä½†æ²¡æœ‰å®ç°é‡è¯•æœºåˆ¶ï¼š

```java
public HttpClient() {
    // åˆ›å»ºVertxå®ä¾‹
    Vertx vertx = Vertx.vertx();
    
    // é…ç½®WebClienté€‰é¡¹
    WebClientOptions options = new WebClientOptions();
    options.setKeepAlive(true);
    options.setConnectTimeout(5000); // è¿æ¥è¶…æ—¶æ—¶é—´
    
    // åˆ›å»ºWebClient
    this.webClient = WebClient.create(vertx, options);
    
    // è®¾ç½®åºåˆ—åŒ–å™¨
    this.serializer = new JdkSerializer();
}
```

ä¸ºäº†å¢å¼ºæ¡†æ¶çš„å¯é æ€§ï¼Œå¯ä»¥è€ƒè™‘ä»¥ä¸‹ä¼˜åŒ–ï¼š

1. å¼•å…¥RetryPolicyå’ŒRetryStrategyçš„æŠ½è±¡è®¾è®¡
2. é»˜è®¤é…ç½®æŒ‡æ•°é€€é¿åŠ æŠ–åŠ¨çš„é‡è¯•ç­–ç•¥
3. æä¾›æ³¨è§£æ”¯æŒï¼Œå…è®¸å¼€å‘è€…ä¸ºä¸åŒæœåŠ¡è‡ªå®šä¹‰é‡è¯•ç­–ç•¥
4. ä¼˜åŒ–æ—¥å¿—å’Œç›‘æ§ï¼Œä¾¿äºæ’æŸ¥é‡è¯•ç›¸å…³é—®é¢˜

## é‡è¯•æœºåˆ¶æœ€ä½³å®è·µ

1. **è®¾ç½®åˆç†çš„æœ€å¤§é‡è¯•æ¬¡æ•°**ï¼šé€šå¸¸3-5æ¬¡è¶³å¤Ÿå¤„ç†å¤§å¤šæ•°ä¸´æ—¶æ€§æ•…éšœ

2. **ä½¿ç”¨é€’å¢çš„é‡è¯•é—´éš”**ï¼šé¿å…åœ¨æœåŠ¡ä¸å¯ç”¨æ—¶ç«‹å³å‘èµ·å¤§é‡é‡è¯•è¯·æ±‚

3. **æ·»åŠ éšæœºæŠ–åŠ¨**ï¼šé˜²æ­¢å¤šä¸ªå®¢æˆ·ç«¯åŒæ—¶é‡è¯•å¯¼è‡´çš„"æƒŠç¾¤æ•ˆåº”"

4. **åŒºåˆ†å¼‚å¸¸ç±»å‹**ï¼šé’ˆå¯¹ä¸åŒç±»å‹çš„å¼‚å¸¸é‡‡ç”¨ä¸åŒçš„é‡è¯•ç­–ç•¥

5. **è®¾ç½®æ€»è¶…æ—¶æ—¶é—´**ï¼šé‡è¯•ç­–ç•¥åº”æœ‰ä¸€ä¸ªæ€»ä½“è¶…æ—¶é™åˆ¶ï¼Œé¿å…æ— é™ç­‰å¾…

6. **è€ƒè™‘æ“ä½œçš„å¹‚ç­‰æ€§**ï¼šç¡®ä¿é‡è¯•ä¸ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´

7. **æ·»åŠ æ—¥å¿—å’Œç›‘æ§**ï¼šè®°å½•é‡è¯•æ¬¡æ•°å’ŒåŸå› ï¼Œæ–¹ä¾¿é—®é¢˜æ’æŸ¥

8. **ç»“åˆç†”æ–­æœºåˆ¶**ï¼šå½“æœåŠ¡æŒç»­å¤±è´¥æ—¶ï¼Œæš‚åœé‡è¯•ï¼Œé¿å…æ— æ•ˆè¯·æ±‚

## æ€»ç»“

## ğŸ§ª æµ‹è¯•éªŒè¯

### é‡è¯•ç­–ç•¥æµ‹è¯•
**æ–‡ä»¶è·¯å¾„**: `rpc-core/src/test/java/com/ming/rpc/fault/retry/RetryStrategyTest.java`

é¡¹ç›®ä¸ºæ¯ä¸ªé‡è¯•ç­–ç•¥éƒ½æä¾›äº†å®Œæ•´çš„æµ‹è¯•ç”¨ä¾‹ï¼š

```java
@Test
@DisplayName("FixedIntervalRetryStrategy: é‡è¯•åæˆåŠŸæµ‹è¯•")
void testFixedIntervalRetryAndSucceed() throws Exception {
    RetryStrategy retryStrategy = new FixedIntervalRetryStrategy();
    final AtomicInteger callCount = new AtomicInteger(0);
    Callable<RpcResponse> callable = () -> {
        int count = callCount.incrementAndGet();
        if (count < 2) {
            System.out.println("Simulating failure on attempt " + count);
            throw new RuntimeException("transient failure");
        }
        System.out.println("Simulating success on attempt " + count);
        return RpcResponse.builder().message("success").build();
    };

    RpcResponse response = retryStrategy.doRetry(callable);
    assertEquals("success", response.getMessage());
    assertEquals(2, callCount.get());
}

@Test
@DisplayName("RetryStrategyFactory: å·¥å‚åŠ è½½æµ‹è¯•")
void testFactory() {
    RetryStrategy noRetry = RetryStrategyFactory.getInstance(RetryStrategyKeys.NO);
    assertTrue(noRetry instanceof NoRetryStrategy);

    RetryStrategy fixedInterval = RetryStrategyFactory.getInstance(RetryStrategyKeys.FIXED_INTERVAL);
    assertTrue(fixedInterval instanceof FixedIntervalRetryStrategy);
}
```

## ğŸ“Š é‡è¯•ç­–ç•¥å¯¹æ¯”

åŸºäºé¡¹ç›®å®é™…å®ç°çš„é‡è¯•ç­–ç•¥å¯¹æ¯”ï¼š

| ç­–ç•¥ | é‡è¯•é—´éš” | å®ç°å¤æ‚åº¦ | æ€§èƒ½å¼€é”€ | é€‚ç”¨åœºæ™¯ |
|------|---------|-----------|----------|----------|
| ä¸é‡è¯• | - | æä½ | æ—  | å®æ—¶æ€§è¦æ±‚é«˜ |
| å›ºå®šé—´éš” | 3ç§’ | ä½ | ä½ | ç½‘ç»œæŠ–åŠ¨ã€ä¸´æ—¶æ•…éšœ |

## ğŸ”§ ä½¿ç”¨æŒ‡å—

### é…ç½®é‡è¯•ç­–ç•¥
åœ¨RPCé…ç½®ä¸­æŒ‡å®šé‡è¯•ç­–ç•¥ï¼š

```yaml
rpc:
  retryStrategy: fixedInterval  # å¯é€‰: no, fixedInterval
```

### ä»£ç ä¸­ä½¿ç”¨
```java
// é€šè¿‡å·¥å‚è·å–é‡è¯•ç­–ç•¥
RetryStrategy retryStrategy = RetryStrategyFactory.getInstance("fixedInterval");

// æ‰§è¡Œé‡è¯•é€»è¾‘
RpcResponse response = retryStrategy.doRetry(() -> {
    return VertexTcpClient.doRequest(rpcRequest, serviceMetaInfo);
});
```

### è‡ªå®šä¹‰é‡è¯•ç­–ç•¥
1. å®ç°RetryStrategyæ¥å£
2. åœ¨SPIé…ç½®æ–‡ä»¶ä¸­æ³¨å†Œ
3. é€šè¿‡é…ç½®ä½¿ç”¨è‡ªå®šä¹‰ç­–ç•¥

```java
// è‡ªå®šä¹‰é‡è¯•ç­–ç•¥
public class ExponentialBackoffRetryStrategy implements RetryStrategy {
    @Override
    public RpcResponse doRetry(Callable<RpcResponse> callable) throws Exception {
        // æŒ‡æ•°é€€é¿é‡è¯•é€»è¾‘
        return callable.call();
    }
}
```

é…ç½®æ–‡ä»¶ï¼š`META-INF/rpc/custom/com.ming.rpc.fault.retry.RetryStrategy`
```
exponentialBackoff=com.example.ExponentialBackoffRetryStrategy
```

## ğŸ¯ æœ€ä½³å®è·µ

### 1. é‡è¯•ç­–ç•¥é€‰æ‹©
- **å®æ—¶äº¤æ˜“**: ä½¿ç”¨ä¸é‡è¯•ç­–ç•¥ï¼Œç¡®ä¿å“åº”é€Ÿåº¦
- **æ•°æ®æŸ¥è¯¢**: ä½¿ç”¨å›ºå®šé—´éš”é‡è¯•ï¼Œå¤„ç†ç½‘ç»œæŠ–åŠ¨
- **æ‰¹é‡å¤„ç†**: ä½¿ç”¨æŒ‡æ•°é€€é¿é‡è¯•ï¼Œé¿å…ç³»ç»Ÿè¿‡è½½
- **å…³é”®ä¸šåŠ¡**: ç»“åˆå®¹é”™ç­–ç•¥ï¼Œæä¾›å¤šå±‚ä¿éšœ

### 2. é‡è¯•å‚æ•°é…ç½®
- **é‡è¯•æ¬¡æ•°**: é€šå¸¸3-5æ¬¡è¶³å¤Ÿå¤„ç†å¤§å¤šæ•°ä¸´æ—¶æ€§æ•…éšœ
- **é‡è¯•é—´éš”**: æ ¹æ®ä¸šåŠ¡ç‰¹ç‚¹è°ƒæ•´ï¼Œé¿å…è¿‡äºé¢‘ç¹
- **è¶…æ—¶æ—¶é—´**: è®¾ç½®åˆç†çš„æ€»è¶…æ—¶æ—¶é—´ï¼Œé¿å…æ— é™ç­‰å¾…

### 3. ç›‘æ§å’Œå‘Šè­¦
- è®°å½•é‡è¯•æ¬¡æ•°å’ŒæˆåŠŸç‡
- ç›‘æ§é‡è¯•å¤±è´¥çš„åŸå› 
- è®¾ç½®é‡è¯•é˜ˆå€¼å‘Šè­¦

### 4. ä¸å®¹é”™æœºåˆ¶ç»“åˆ
```java
try {
    // å…ˆæ‰§è¡Œé‡è¯•ç­–ç•¥
    RetryStrategy retryStrategy = RetryStrategyFactory.getInstance(config.getRetryStrategy());
    return retryStrategy.doRetry(() -> doRpcCall(request));
} catch (Exception e) {
    // é‡è¯•å¤±è´¥åæ‰§è¡Œå®¹é”™ç­–ç•¥
    TolerantStrategy tolerantStrategy = TolerantStrategyFactory.getInstance(config.getTolerantStrategy());
    return tolerantStrategy.doTolerant(context, e);
}
```

## ğŸ“ˆ æ‰©å±•å¼€å‘

### æ·»åŠ æ–°çš„é‡è¯•ç­–ç•¥
1. å®ç°RetryStrategyæ¥å£
2. æ·»åŠ ç­–ç•¥å¸¸é‡
3. åˆ›å»ºSPIé…ç½®
4. å®ç°å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹

### ç¤ºä¾‹ï¼šæ·»åŠ æŒ‡æ•°é€€é¿é‡è¯•ç­–ç•¥
```java
// 1. å®šä¹‰æŒ‡æ•°é€€é¿é‡è¯•ç­–ç•¥
public class ExponentialBackoffRetryStrategy implements RetryStrategy {
    @Override
    public RpcResponse doRetry(Callable<RpcResponse> callable) throws Exception {
        Retryer<RpcResponse> retryer = RetryerBuilder.<RpcResponse>newBuilder()
            .retryIfExceptionOfType(Exception.class)
            .withWaitStrategy(WaitStrategies.exponentialWait(1000, 30, TimeUnit.SECONDS))
            .withStopStrategy(StopStrategies.stopAfterAttempt(5))
            .build();
        return retryer.call(callable);
    }
}

// 2. æ·»åŠ åˆ°å¸¸é‡ç±»
public interface RetryStrategyKeys {
    String EXPONENTIAL_BACKOFF = "exponentialBackoff";
}

// 3. SPIé…ç½®
exponentialBackoff=com.ming.rpc.fault.retry.ExponentialBackoffRetryStrategy
```

## ğŸ“‹ æ€»ç»“

Ming RPC Frameworkçš„é‡è¯•æœºåˆ¶é€šè¿‡ç²¾å¿ƒè®¾è®¡çš„æ¶æ„ï¼Œæä¾›äº†å¯é çš„æ•…éšœå¤„ç†è§£å†³æ–¹æ¡ˆï¼š

### æ ¸å¿ƒä¼˜åŠ¿
- âœ… **å¤šç§é‡è¯•ç­–ç•¥**: ä¸é‡è¯•ã€å›ºå®šé—´éš”é‡è¯•ä¸¤ç§ç­–ç•¥
- âœ… **SPIæœºåˆ¶æ‰©å±•**: é€šè¿‡SPIæœºåˆ¶å®ç°é‡è¯•ç­–ç•¥çš„åŠ¨æ€åŠ è½½å’Œæ‰©å±•
- âœ… **å·¥å‚æ¨¡å¼ç®¡ç†**: ç»Ÿä¸€çš„é‡è¯•ç­–ç•¥å·¥å‚ç®¡ç†å’Œåˆ›å»º
- âœ… **å®Œå–„çš„æµ‹è¯•**: æ¯ä¸ªé‡è¯•ç­–ç•¥éƒ½æœ‰å¯¹åº”çš„æµ‹è¯•ç”¨ä¾‹éªŒè¯
- âœ… **ä¸å®¹é”™é›†æˆ**: ä¸å®¹é”™æœºåˆ¶å®Œç¾ç»“åˆï¼Œæä¾›å¤šå±‚ä¿éšœ

### æŠ€æœ¯ç‰¹è‰²
- **å¯æ’æ‹”è®¾è®¡**: é€šè¿‡æ¥å£æŠ½è±¡å’ŒSPIæœºåˆ¶å®ç°å¯æ’æ‹”
- **é…ç½®é©±åŠ¨**: é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶ä½¿ç”¨å“ªç§é‡è¯•ç­–ç•¥
- **åŸºäºGuava**: ä½¿ç”¨Guava Retryingåº“ï¼ŒåŠŸèƒ½å¼ºå¤§ä¸”ç¨³å®š
- **æ™ºèƒ½é‡è¯•**: æ”¯æŒå¼‚å¸¸ç±»å‹åˆ¤æ–­å’Œé‡è¯•ç›‘å¬

### é‡è¯•èƒ½åŠ›
- **ä¸é‡è¯•**: é€‚ç”¨äºå¯¹å®æ—¶æ€§è¦æ±‚æé«˜çš„åœºæ™¯
- **å›ºå®šé—´éš”**: é€‚ç”¨äºç½‘ç»œæŠ–åŠ¨ç­‰ä¸´æ—¶æ€§æ•…éšœ
- **å¯æ‰©å±•**: æ”¯æŒè‡ªå®šä¹‰é‡è¯•ç­–ç•¥ï¼Œæ»¡è¶³ç‰¹æ®Šéœ€æ±‚

Ming RPC Frameworkçš„é‡è¯•æœºåˆ¶ä¸ºåˆ†å¸ƒå¼RPCè°ƒç”¨æä¾›äº†å¼ºæœ‰åŠ›çš„å¯é æ€§ä¿éšœï¼Œç¡®ä¿äº†ç³»ç»Ÿåœ¨é¢å¯¹ä¸´æ—¶æ€§æ•…éšœæ—¶çš„ç¨³å®šæ€§å’Œå¯ç”¨æ€§ã€‚